# Flutter è‡ªåŠ¨æ‰¹ä½œä¸šAPPï¼šåŸå‹å›¾ + æŠ€æœ¯é€‰å‹ + ç›®å½•ä¸æ¶æ„ï¼ˆv1ï¼‰

> ç›®æ ‡ï¼šé¢å‘â€œæ‹ç…§â†’OCRâ†’è§£æâ†’åˆ¤åˆ†â†’æŠ¥å‘Šâ€çš„ç§»åŠ¨ç«¯åº”ç”¨ã€‚æœ¬æ–‡ç»™å‡º**å¯è½åœ°**çš„åŸå‹è‰å›¾ã€Flutter æŠ€æœ¯é€‰å‹ã€ç›®å½•ç»“æ„ä¸åˆ†å±‚æ¶æ„ï¼Œå¹¶é™„å…³é”®ä»£ç éª¨æ¶ã€‚

---

## 1. ä¿¡æ¯æ¶æ„ & ç”¨æˆ·æµç¨‹

```
å­¦ç”Ÿ/æ•™å¸ˆ â†’ ç™»å½•/é€‰æ‹©ç­çº§ â†’ ä½œä¸šåˆ—è¡¨ â†’ (å­¦ç”Ÿ) æ‹ç…§æäº¤ â†’ çŠ¶æ€è®¢é˜… â†’ åˆ¤åˆ†ç»“æœ/è§£æ
                                     â†˜ (æ•™å¸ˆ) å»ºä½œä¸š/å½•ç­”æ¡ˆ â†’ æŸ¥çœ‹ç»Ÿè®¡
```

**å…³é”®çŠ¶æ€æµ**

```
queued â†’ ocr â†’ parsed â†’ graded â†’ reported
```

App é€šè¿‡ WebSocket è®¢é˜… `submissionId` çš„çŠ¶æ€å¹¶å®æ—¶æ›´æ–° UIã€‚

---

## 2. åŸå‹å›¾ï¼ˆä½ä¿çœŸè‰å›¾ï¼‰

> è¯´æ˜ï¼šASCII çº¿æ¡†å›¾ä»…ç”¨äºäº§å“ç»“æ„è®¨è®ºï¼Œåç»­å¯å¯¼å…¥ Figma/Flutter UI å®ç°ã€‚

### 2.1 å­¦ç”Ÿç«¯

**A. ä½œä¸šåˆ—è¡¨**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ‡é¢˜ï¼šæœ¬å‘¨ä½œä¸š(è¯­æ–‡/æ•°å­¦)        [ğŸ”] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å¡ç‰‡] è¯­æ–‡Â·å¤è¯—è¯é»˜å†™ â€” æˆªæ­¢ 10/08 â”‚
â”‚  çŠ¶æ€ï¼šæœªæäº¤  [å»æäº¤]              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å¡ç‰‡] æ•°å­¦Â·ç­‰å¼/ç®—å¼ â€” æˆªæ­¢ 10/09  â”‚
â”‚  çŠ¶æ€ï¼šå·²æäº¤  åˆ†æ•°ï¼š85  [æŸ¥çœ‹]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**B. æ‹ç…§ä¸é¢„å¤„ç†**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æäº¤ï¼šè¯­æ–‡Â·å¤è¯—è¯é»˜å†™               â”‚
â”‚  [ ç›¸æœºå–æ™¯ ]  è¾¹ç¼˜æ£€æµ‹/é€è§†æ ¡æ­£æç¤º â”‚
â”‚  [ é‡æ–°æ‹ ]  [ æ‰¹é‡æ¨¡å¼ ]           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ç¼©ç•¥å›¾1][ç¼©ç•¥å›¾2][+ æ·»åŠ ]          â”‚
â”‚ [ä¸‹ä¸€æ­¥ï¼šåŒºåŸŸæ ‡æ³¨/ä¸Šä¼ ]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**C. ä¸Šä¼ ä¸è¿›åº¦**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ­£åœ¨æäº¤â€¦  60%                    â”‚
â”‚  çŠ¶æ€ï¼šocr â†’ parsed (WebSocket)    â”‚
â”‚  [å–æ¶ˆ] [åå°ä¸Šä¼ ]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**D. åˆ¤åˆ†ç»“æœï¼ˆè¯­æ–‡ï¼‰**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»“æœï¼š87/100  ç”¨æ—¶ï¼š18s            â”‚
â”‚  ç¬¬1é¢˜(1åˆ†/è¡Œ)ï¼š                     â”‚
â”‚   æ ‡å‡†ï¼šæ˜¥çœ ä¸è§‰æ™“                    â”‚
â”‚   ä½ çš„ï¼šæ˜¥çœ ä¸è§‰**å°**      (é”™å­— é«˜äº®) â”‚
â”‚  [è¡Œå¯¹æ¯”] [é”™å› æ ‡ç­¾ï¼šè¯¯å†™/ç¼ºå­—]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç¬¬2é¢˜â€¦                              â”‚
â”‚  [æŸ¥çœ‹è§£æ]  [çŸ¥è¯†ç‚¹ç»Ÿè®¡]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**E. åˆ¤åˆ†ç»“æœï¼ˆæ•°å­¦ï¼‰**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç»“æœï¼šç­‰å¼ç­‰ä»· âœ…                    â”‚
â”‚  æ ¡éªŒï¼šåœ¨æ ·æœ¬ç‚¹( x=1.2, x=-0.5 )å‡æˆç«‹ â”‚
â”‚  ä½ çš„ï¼š (x+1)^2                      â”‚
â”‚  æ ‡å‡†ï¼š x^2+2x+1                     â”‚
â”‚  [ç­‰ä»·è¯´æ˜] [æŸ¥çœ‹æ¼”ç®—]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ•™å¸ˆç«¯ï¼ˆç§»åŠ¨ç«¯ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç­çº§ï¼šå…­(1)ç­  [åˆ‡æ¢]               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å­¦ç”Ÿæ­£ç¡®ç‡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¯­æ–‡(æœ¬å‘¨)ï¼š 78%   æ•°å­¦ï¼š 71%         â”‚
â”‚  [æ–°å»ºä½œä¸š] [å¯¼å…¥ç­”æ¡ˆ] [ç»Ÿè®¡/å¯¼å‡º]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. Flutter æŠ€æœ¯é€‰å‹ï¼ˆMVPâ†’å¢å¼ºï¼‰

* **æ¡†æ¶/åŸºç¡€**ï¼šFlutter 3.22+ã€Dart 3ã€Material 3ã€æš—è‰²æ¨¡å¼
* **è·¯ç”±**ï¼š`go_router`ï¼ˆå£°æ˜å¼å¯¼èˆªã€æ·±é“¾ï¼‰
* **çŠ¶æ€ç®¡ç†**ï¼š`riverpod`/`hooks_riverpod` + `AsyncNotifier`ï¼ˆæˆ– `StateNotifier`ï¼‰
* **ç½‘ç»œ**ï¼š`dio`ï¼ˆæ‹¦æˆªå™¨/é‡è¯•/å–æ¶ˆï¼‰ + `retrofit`ï¼ˆå¯é€‰ï¼Œç±»å‹å®‰å…¨ï¼‰
* **åºåˆ—åŒ–**ï¼š`freezed` + `json_serializable`ï¼ˆä¸å¯å˜æ•°æ®æ¨¡å‹/æ¨¡å¼åŒ¹é…ï¼‰
* **æœ¬åœ°å­˜å‚¨**ï¼š`hive`ï¼ˆç¦»çº¿ç¼“å­˜/ä¸Šä¼ é˜Ÿåˆ—ï¼‰+ `flutter_secure_storage`ï¼ˆTokenï¼‰
* **å›¾ç‰‡/ç›¸æœº**ï¼š`camera`ã€`image_picker`ã€`image`ï¼ˆè£åˆ‡/å»å™ª/å‹ç¼©ï¼‰
* **OCR å‰å¤„ç†**ï¼šè¾¹ç¼˜æ£€æµ‹/é€è§†çŸ«æ­£ï¼ˆå‰ç«¯ä»…åšè½»é¢„å¤„ç†ï¼›OCR ä¸»è¦åœ¨åç«¯ï¼‰
* **å®æ—¶é€šä¿¡**ï¼š`web_socket_channel`ï¼ˆè®¢é˜…æäº¤è¿›åº¦ï¼‰
* **æ–­ç‚¹ç»­ä¼ **ï¼š`dio` + åç«¯ S3/OSS ç›´ä¼ ï¼ˆé¢„ç­¾å URLï¼‰
* **å¤šç¯å¢ƒ**ï¼š`flutter_dotenv` + Flavorsï¼ˆdev/stg/prodï¼‰
* **å›½é™…åŒ–**ï¼š`intl` + `flutter_localizations`
* **æ—¥å¿—/ç›‘æ§**ï¼š`logger`ã€`sentry_flutter`ï¼ˆå¯é€‰ï¼‰
* **æµ‹è¯•**ï¼š`flutter_test`ã€`mocktail`ã€`golden_toolkit`ï¼ˆé‡‘æ ·å›¾ï¼‰

> å¯é€‰å¢å¼ºï¼šå¦‚éœ€ç«¯ä¸Šå³æ—¶â€œç²—åˆ¤â€ï¼Œå¯æ¥ `google_mlkit_text_recognition` åšå¿«é€Ÿåé¦ˆï¼Œä½†**ä»¥æœåŠ¡ç«¯OCRä¸ºå‡†**ã€‚

---

## 3.1 è‹±æ–‡ä½œä¸šå…¼å®¹ï¼ˆå‰ç«¯ä¸åˆ¤åˆ†å±•ç¤ºï¼‰

**ç›®æ ‡**ï¼šåœ¨ä¸æ”¹å˜æ•´ä½“æ¶æ„å‰æä¸‹ï¼Œæ–°å¢å¯¹è‹±æ–‡ä½œä¸šï¼ˆæ‹¼å†™ã€è¯ç»„/å¥å­é»˜å†™ã€å¡«ç©ºï¼‰çš„è¯†åˆ«ä¸åˆ¤åˆ†ï¼Œæ²¿ç”¨æ‹ç…§â†’OCRâ†’è§£æâ†’åˆ¤åˆ†â†’æŠ¥å‘Šæµç¨‹ã€‚

### A. é¢˜å‹ä¸åˆ¤åˆ†ç­–ç•¥ï¼ˆEnglishï¼‰

* **Spelling / Word List**ï¼šæŒ‰ word-level ç²¾ç¡®/æ¨¡ç³ŠåŒ¹é…ï¼›å¯è®¾ç½®æ¯è¯å®¹é”™é˜ˆå€¼ï¼ˆç¼–è¾‘è·ç¦»ï¼‰ã€‚
* **Sentence Dictation / Quote**ï¼šæŒ‰ token åºåˆ—æ¯”å¯¹ï¼›å¯é…ç½®å¤§å°å†™ä¸æ ‡ç‚¹ç­–ç•¥ï¼ˆå¿½ç•¥/ä¸¥æ ¼ï¼‰ã€‚
* **Fill-in-the-Blank**ï¼šæ”¯æŒåŒä¹‰è¯/è¯å½¢å˜åŒ–ï¼ˆvariants/regexï¼‰ï¼Œå¹¶å¯é…ç½®å¤§å°å†™/æ ‡ç‚¹æ”¿ç­–ã€‚

### B. OCR è·¯ç”±

* é¢˜å‹ä¸ºè‹±æ–‡æ—¶ä¼˜å…ˆé€‰æ‹©æ‹‰ä¸/æ‰‹å†™ä¼˜åŒ–çš„ OCR é€šé“ï¼ˆäº‘å‚å•†æˆ–è‡ªå»ºï¼‰ã€‚
* ï¼ˆå¯é€‰ï¼‰ç«¯ä¸Šå¿«é€Ÿè¯†åˆ«ä»…ä½œå³æ—¶æç¤ºï¼Œæœ€ç»ˆä»¥æœåŠ¡ç«¯ç»“æœä¸ºå‡†ã€‚

### C. è‹±æ–‡æ ‡å‡†åŒ–ï¼ˆNormalizationï¼‰

* ç»Ÿä¸€ï¼šå¤§å°å†™ï¼ˆå¯é€‰ï¼‰ã€æ™ºèƒ½å¼•å·/ç ´æŠ˜å·â†’ASCIIã€å…¨/åŠè§’ã€ç©ºç™½æŠ˜å ã€ï¼ˆå¯é€‰ï¼‰å»é™¤å˜éŸ³ç¬¦ã€‚
* å¸¸è§ OCR æ··æ·†æ˜ å°„ï¼šlâ†”1ã€Oâ†”0ã€rnâ†”mã€clâ†”dã€Bâ†”8ã€Sâ†”5ï¼ˆåœ¨ä½ç½®ä¿¡åº¦æ—¶å¯ç”¨ï¼‰ã€‚
* è‹±å¼/ç¾å¼æ‹¼å†™æ˜ å°„ï¼ˆå¯é€‰ï¼‰ï¼šcolourâ†”colorã€organiseâ†”organize ç­‰ï¼ˆä½œä¸šé…ç½®å¼€å…³ï¼‰ã€‚

### D. å‰ç«¯ UI è¡¨è¾¾

* word-level é«˜äº®ï¼šæ­£ç¡®ï¼ˆæ­£å¸¸ï¼‰ã€é”™è¯ï¼ˆçº¢åº•/ä¸‹åˆ’çº¿ï¼‰ã€å¤šå†™ï¼ˆåˆ é™¤çº¿ï¼‰ã€å°‘å†™ï¼ˆç°è‰²å ä½ï¼‰ã€æ ‡ç‚¹é”™è¯¯ï¼ˆè“è‰²è¾¹æ¡†ï¼‰ã€‚
* ç»Ÿè®¡ï¼šWERï¼ˆè¯é”™è¯¯ç‡ï¼‰ã€å¸¸è§é”™æ‹¼ TopNã€æ ‡ç‚¹/å¤§å°å†™é”™è¯¯è®¡æ•°ã€‚

### E. AnswerKey æ‰©å±•ï¼ˆä¸åç«¯å…±äº«çš„ schema æ€è·¯ï¼‰

```json
{
  "type": "en_text",
  "policy": { "caseSensitive": false, "ignorePunct": true, "allowBritish": true, "maxTyposPerWord": 1 },
  "lines": [
    { "text": "To be, or not to be", "variants": ["to be or not to be"] },
    { "text": "that's the question", "variants": ["that is the question"] }
  ]
}
```

### F. è¯­è¨€æ ‡è®°ä¸åˆ‡æ¢

* ä½œä¸š/é¢˜ç›®å¢åŠ  `language: zh|en|auto`ï¼›`auto` æ—¶ç”±æœåŠ¡ç«¯æ ¹æ® OCR è¿”å›è¯­è¨€/è„šæœ¬åˆ¤å®šã€‚
* å‰ç«¯æ®è¯­è¨€åˆ‡æ¢ï¼šUI æ–‡æ¡ˆã€é»˜è®¤æ ‡å‡†åŒ–ç­–ç•¥ã€é”™å› æ ‡ç­¾ä¸ç»Ÿè®¡å£å¾„ã€‚

### G. æŒ‡æ ‡ä¸éªŒæ”¶ï¼ˆEnglishï¼‰

* è¯†åˆ«ï¼šè‹±æ–‡æ‰‹å†™/å°åˆ·ä½“ WERã€ä½ç½®ä¿¡åº¦æ¯”ä¾‹ã€‚
* åˆ¤åˆ†ï¼šæ‹¼å†™é¢˜å‡†ç¡®ç‡ã€å¥å­é¢˜ WERã€é”™è¯¯ç±»åˆ«åˆ†å¸ƒã€‚
* ä½“éªŒï¼šP95 ç«¯åˆ°ç«¯æ—¶å»¶ã€å¼±ç½‘é‡è¯•æˆåŠŸç‡ã€‚

---

## 4. å·¥ç¨‹ç›®å½•ï¼ˆfeature-first + clean architectureï¼‰

```
lib/
â”œâ”€ app/
â”‚  â”œâ”€ app.dart                 # MaterialAppã€ä¸»é¢˜ã€GoRouter æ³¨å…¥
â”‚  â””â”€ di.dart                  # ProviderScopeã€å…¨å±€ä¾èµ–è£…é…
â”œâ”€ core/
â”‚  â”œâ”€ config/                  # ç¯å¢ƒé…ç½®ã€å¸¸é‡ã€è·¯ç”±å‘½å
â”‚  â”œâ”€ error/                   # AppExceptionã€ErrorMapper
â”‚  â”œâ”€ network/                 # Dio/Retrofit å®¢æˆ·ç«¯ã€æ‹¦æˆªå™¨ã€WebSocket
â”‚  â”œâ”€ storage/                 # Hive/secure storage å°è£…
â”‚  â”œâ”€ utils/                   # æ–‡æœ¬æ ‡å‡†åŒ–/å›¾åƒå·¥å…·/æ ¼å¼åŒ–
â”‚  â””â”€ widgets/                 # é€šç”¨ç»„ä»¶(æŒ‰é’®/å ä½/ç©ºæ€)
â”œâ”€ features/
â”‚  â”œâ”€ auth/
â”‚  â”‚  â”œâ”€ data/    (dto, repo impl)
â”‚  â”‚  â”œâ”€ domain/  (entity, repo, usecase)
â”‚  â”‚  â””â”€ presentation/ (pages, providers, widgets)
â”‚  â”œâ”€ assignment/
â”‚  â”œâ”€ submission/
â”‚  â”‚  â”œâ”€ data/    (ä¸Šä¼ é˜Ÿåˆ—, WS è®¢é˜…, API)
â”‚  â”‚  â”œâ”€ domain/  (Submission, çŠ¶æ€æœº, ç”¨ä¾‹)
â”‚  â”‚  â””â”€ presentation/ (æ‹ç…§/é¢„è§ˆ/è¿›åº¦/ç»“æœ)
â”‚  â””â”€ analytics/
â”œâ”€ l10n/                      # å¤šè¯­è¨€
â”œâ”€ main.dart
â””â”€ main_dev.dart|main_stg.dart|main_prod.dart  # Flavors å…¥å£

assets/
â”œâ”€ fonts/  images/  icons/
```

---

## 5. åˆ†å±‚æ¶æ„ï¼ˆClean Architectureï¼‰

```
Presentation (Flutter UI, Riverpod providers)
   â†‘  ä¾èµ–
Domain (Entities, Value Objects, Repositoriesæ¥å£, UseCases)
   â†‘  ä¾èµ–
Data   (DTO, Mappers, RemoteDataSource/API, LocalDataSource)
```

**è¦ç‚¹**

* `Domain` ä¸ä¾èµ– Flutterï¼›ä¿æŒçº¯ Dartï¼Œå¯æµ‹è¯•æ€§é«˜ã€‚
* `Data` æŒæœ‰å…·ä½“å®ç°ï¼ˆDio/Hive/WSï¼‰ï¼Œé€šè¿‡æ¥å£æ³¨å…¥åˆ° `Domain`ã€‚
* `Presentation` åªä¸ `UseCase`/`Entity` äº¤äº’ï¼Œç”± Provider ä¸²è”ç”Ÿå‘½å‘¨æœŸã€‚

---

## 6. å…³é”®æ•°æ®æ¨¡å‹ï¼ˆDart / freezed ç¤ºä¾‹ï¼‰

```dart
@freezed
class Submission with _$Submission {
  const factory Submission({
    required String id,
    required String assignmentId,
    required String studentId,
    required SubmissionStatus status, // queued/ocr/parsed/graded/reported
    @Default([]) List<ImageAsset> images,
    ScoreReport? report,
  }) = _Submission;
}

enum SubmissionStatus { queued, ocr, parsed, graded, reported }

@freezed
class ScoreReport with _$ScoreReport {
  const factory ScoreReport({
    required int total,
    required int obtained,
    required List<ItemResult> items,
  }) = _ScoreReport;
}
```

---

## 7. ç½‘ç»œå±‚ä¸æ‹¦æˆªå™¨ï¼ˆDioï¼‰

```dart
class ApiClient {
  final Dio dio;
  ApiClient(String baseUrl, {String? token})
      : dio = Dio(BaseOptions(baseUrl: baseUrl)) {
    dio.interceptors.addAll([
      InterceptorsWrapper(onRequest: (o, h) {
        if (token != null) o.headers['Authorization'] = 'Bearer $token';
        return h.next(o);
      }),
      LogInterceptor(responseBody: false),
    ]);
  }

  Future<PresignResp> presignUpload(String filename, int size) async {
    final r = await dio.post('/media/presign', data: {
      'filename': filename,
      'size': size,
    });
    return PresignResp.fromJson(r.data);
  }
}
```

---

## 8. è·¯ç”±ï¼ˆgo_routerï¼‰ä¸å¯¼èˆª

```dart
final router = GoRouter(
  routes: [
    GoRoute(path: '/', builder: (_, __) => const HomePage()),
    GoRoute(path: '/assignments', builder: (_, __) => const AssignmentListPage()),
    GoRoute(path: '/submit/:id', builder: (c, s) => SubmitPage(id: s.pathParameters['id']!)),
    GoRoute(path: '/result/:sid', builder: (c, s) => ResultPage(submissionId: s.pathParameters['sid']!)),
  ],
);
```

---

## 9. Riverpodï¼šæäº¤æµç¨‹ Providerï¼ˆéª¨æ¶ï¼‰

```dart
@riverpod
class SubmissionController extends _$SubmissionController {
  @override
  Future<Submission?> build() async => null;

  Future<String> create({required String assignmentId, required List<File> images}) async {
    // 1) ç›´ä¼ å¯¹è±¡å­˜å‚¨: presign â†’ dio.put â†’ å¾—åˆ° keys
    // 2) åˆ›å»º submissionï¼ˆPOST /submissionsï¼‰â†’ è¿”å› submissionId
    // 3) å»ºç«‹ WS è®¢é˜…ï¼Œæ›´æ–° state
    return 'submissionId';
  }

  Stream<SubmissionStatus> subscribe(String submissionId) {
    // WebSocket è®¢é˜…æœåŠ¡ç«¯çŠ¶æ€
    // æ›´æ–° state = state.copyWith(status: ...)
    throw UnimplementedError();
  }
}
```

---

## 10. æ‹ç…§ä¸é¢„å¤„ç†ï¼ˆè¦ç‚¹ï¼‰

* **å–æ™¯å¼•å¯¼**ï¼šå¯¹é½è¾¹ç¼˜ã€å…‰çº¿è¿‡æš—æç¤ºï¼›æ‰¹é‡è¿æ‹æ¨¡å¼ã€‚
* **è½»é¢„å¤„ç†**ï¼šå‹ç¼©ã€å»å™ªã€é€è§†çŸ«æ­£ï¼›æ§åˆ¶å•å¼ ä¸Šä¼ å¤§å°ï¼ˆå¦‚ <1.5MBï¼‰ã€‚
* **å¯é€‰æ¨¡æ¿æ ‡æ³¨**ï¼šæ•™å¸ˆç«¯ä¸ºâ€œé¢˜åŒº/ç­”æ¡ˆåŒºâ€ç”»æ¡†ï¼Œå®¢æˆ·ç«¯å¸¦ä¸Šåæ ‡ï¼Œåç«¯å¯å¯¹åŒºåŸŸåšæœ‰é’ˆå¯¹çš„ OCRã€‚

---

## 11. UI ç»„ä»¶ä¸é£æ ¼

* **è®¾è®¡è¯­è¨€**ï¼šMaterial 3ã€å¼ºè°ƒæ˜“è¯»/å¯¹æ¯”ï¼ˆCorrectâœ…/é”™è¯¯âŒé«˜äº®ï¼‰ã€‚
* **è¯­æ–‡ç»“æœé«˜äº®**ï¼š`RichText + TextSpan` æ¸²æŸ“é”™å­—ï¼ˆçº¢åº•/ä¸‹åˆ’çº¿ï¼‰ï¼Œç¼ºæ¼ï¼ˆç°è‰²å ä½ï¼‰ï¼Œå¤šå†™ï¼ˆåˆ é™¤çº¿ï¼‰ã€‚
* **æ•°å­¦ç­‰ä»·è¯´æ˜**ï¼šå±•ç¤º 2~3 ä¸ªé‡‡æ ·ç‚¹éªŒè¯è¡¨æ ¼ï¼Œå¢åŠ å¯è§£é‡Šæ€§ã€‚

---

## 12. å¤šç¯å¢ƒä¸é…ç½®

* `main_dev.dart / main_stg.dart / main_prod.dart` åŒºåˆ† API åŸŸåã€æ—¥å¿—çº§åˆ«ã€‚
* `.env`ï¼š`API_BASE_URL, WS_URL, S3_BUCKET, FEATURE_FLAGS`ã€‚
* æ„å»ºï¼š`--dart-define-from-file=.env.prod`ã€‚

---

## 13. æƒé™ä¸å‘å¸ƒæ¸…å•

* Androidï¼š`CAMERA`, `READ/WRITE_EXTERNAL_STORAGE`ï¼ˆæŒ‰éœ€ï¼‰ã€`INTERNET`ã€‚
* iOSï¼š`NSCameraUsageDescription`ã€`NSPhotoLibraryAddUsageDescription`ã€‚
* åº”ç”¨åˆ†å‘ï¼šå†…éƒ¨æµ‹è¯•ï¼ˆFirebase App Distribution/TestFlightï¼‰â†’ ç°åº¦ â†’ æ­£å¼ã€‚

---

## 14. é‡Œç¨‹ç¢‘

* **M0**ï¼šéª¨æ¶æ­å»ºï¼ˆç›®å½•ã€è·¯ç”±ã€ä¸»é¢˜ã€ä¾èµ–æ³¨å…¥ã€ç½‘ç»œå±‚ï¼‰
* **M1**ï¼šæ‹ç…§/æ‰¹é‡ä¸Šä¼ /WS çŠ¶æ€è®¢é˜…ï¼ˆé—­ç¯ï¼‰
* **M2**ï¼šç»“æœé¡µï¼ˆè¯­æ–‡é«˜äº®/æ•°å­¦ç­‰ä»·è¯´æ˜ï¼‰+ ç¼“å­˜ä¸å¤±è´¥é‡è¯•
* **M3**ï¼šæ•™å¸ˆç«¯ä½œä¸šç®¡ç† + é¢˜åŒºæ¨¡æ¿æ ‡æ³¨ + æŠ¥è¡¨
* **M4**ï¼šç¦»çº¿åˆ¤åˆ†å…œåº•ï¼ˆå¯é€‰ï¼‰ã€UI æ‰“ç£¨ã€ç›‘æ§ä¸åŸ‹ç‚¹

---

### é™„ï¼šä¾èµ–æ¸…å•ï¼ˆç¤ºä¾‹ï¼‰

```
dependencies:
  flutter:
    sdk: flutter
  go_router: ^14.0.0
  flutter_riverpod: ^3.0.0
  hooks_riverpod: ^3.0.0
  dio: ^5.7.0
  retrofit: ^4.0.0
  json_annotation: ^4.9.0
  freezed_annotation: ^2.4.0
  hive: ^2.2.0
  hive_flutter: ^1.1.0
  flutter_secure_storage: ^9.0.0
  camera: ^0.11.0
  image_picker: ^1.1.0
  image: ^4.2.0
  web_socket_channel: ^3.0.0
  intl: ^0.19.0
  logger: ^2.0.0

dev_dependencies:
  build_runner: ^2.4.0
  freezed: ^2.4.0
  json_serializable: ^6.8.0
  flutter_test:
    sdk: flutter
```